# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –∏–º–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üéØ –ó–∞–¥–∞—á–∞:

**–°–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥–µ–ª–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –≤–º–µ—Å—Ç–æ ID.**


### UserService - —Ä–∞–±–æ—Ç–∞ —Å –∏–º–µ–Ω–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
1. –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–æ–≤–µ—Ä–∫–∏: —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ª–∏ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø–æ–ª—É—á–µ–Ω–∏—è –∏–º–µ–Ω–∏ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
3. –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–º–µ–Ω–∏:
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ (SharedPreferences)
   - –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Supabase (`user_name` –∫–æ–ª–æ–Ω–∫–∞)

**–ó–∞—á–µ–º:** –ß—Ç–æ–±—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–Ω–∞–ª–æ –µ—Å—Ç—å –ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–º—è –∏ –º–æ–≥–ª–æ –µ–≥–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å/–ø–æ–ª—É—á–∞—Ç—å.

---

### WelcomeScreen - —ç–∫—Ä–∞–Ω –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞**

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —ç–∫—Ä–∞–Ω/–∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ä—ã–π —Å –ø–æ–ª–µ–º –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏
2. –ö–Ω–æ–ø–∫–∞ "Continue" —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–º—è —á–µ—Ä–µ–∑ UserService
3. –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ MainScreen

**–ó–∞—á–µ–º:** –°–æ–±—Ä–∞—Ç—å –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

### –†–æ—É—Ç–∏–Ω–≥ –≤ main.dart**

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
1. –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å: –µ—Å—Ç—å –ª–∏ –∏–º—è?
2. –ï—Å–ª–∏ –∏–º–µ–Ω–∏ –ù–ï–¢ ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å WelcomeScreen
3. –ï—Å–ª–∏ –∏–º—è –ï–°–¢–¨ ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å MainScreen –∫–∞–∫ –æ–±—ã—á–Ω–æ

**–ó–∞—á–µ–º:** –ß—Ç–æ–±—ã –Ω–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥–µ–ª–∏ WelcomeScreen, –∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ä–∞–∑—É –ø–æ–ø–∞–¥–∞–ª–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

---

### GuardiansService - –ø–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å
2. –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø–æ–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID:
   - –ó–∞–ø—Ä–æ—Å –≤ Supabase: `SELECT user_name FROM users WHERE user_id = 'XXX'`
   - –í–µ—Ä–Ω—É—Ç—å –∏–º—è –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ, null –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ

**–ó–∞—á–µ–º:** –ß—Ç–æ–±—ã –ø—Ä–∏ –≤–≤–æ–¥–µ ID —Ö—Ä–∞–Ω–∏—Ç–µ–ª—è –º–æ–∂–Ω–æ –±—ã–ª–æ —É–∑–Ω–∞—Ç—å –µ–≥–æ –∏–º—è –∏–∑ –±–∞–∑—ã.

---

### GuardiansScreen - —É–ª—É—á—à–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
1. –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç ID —Ö—Ä–∞–Ω–∏—Ç–µ–ª—è ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–∫–∞—Ç—å —ç—Ç–æ—Ç ID —á–µ—Ä–µ–∑ GuardiansService
2. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å "‚úì Found: [–ò–º—è]" –ø–æ–¥ –ø–æ–ª–µ–º ID
3. –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å "‚ö†Ô∏è User not found"
4. –î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø–æ–ª–µ "Nickname" (–ª–∏—á–Ω–æ–µ –∏–º—è –¥–ª—è —Å–µ–±—è, –Ω–∞–ø—Ä–∏–º–µ—Ä "Mom")
5. –°–æ—Ö—Ä–∞–Ω—è—Ç—å:
   - Guardian ID
   - Nickname (–µ—Å–ª–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω)

**–ó–∞—á–µ–º:** –ß—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–µ–ª –∫–æ–≥–æ –¥–æ–±–∞–≤–ª—è–µ—Ç –∏ –º–æ–≥ –¥–∞—Ç—å —Å–≤–æ–µ –ª–∏—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ.

---

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ö—Ä–∞–Ω–∏—Ç–µ–ª–µ–π —ç–∫—Ä–∞–Ω —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å**

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
1. –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–ø–∏—Å–∫–∞ —Ö—Ä–∞–Ω–∏—Ç–µ–ª–µ–π ‚Üí –¥–ª—è –∫–∞–∂–¥–æ–≥–æ ID –¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å –≤ Supabase
2. –ï—Å–ª–∏ –∏–º—è –Ω–∞–π–¥–µ–Ω–æ ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å "–ò–º—è (Nickname)"
3. –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å "User ID"
4. –ü–æ–¥ –∏–º–µ–Ω–µ–º –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å ID –º–µ–ª–∫–∏–º —à—Ä–∏—Ñ—Ç–æ–º

**–ó–∞—á–µ–º:** –ß—Ç–æ–±—ã –≤ —Å–ø–∏—Å–∫–µ –±—ã–ª–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞, –∞ –Ω–µ –Ω–∞–±–æ—Ä –±—É–∫–≤ –∏ —Ü–∏—Ñ—Ä.

---

### MainScreen - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–≤–æ–µ–≥–æ –∏–º–µ–Ω–∏**

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
1. –í –∫–∞—Ä—Ç–æ—á–∫–µ "My ID" –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –Ω–∞–¥ ID
2. –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "Edit Name" –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–º–µ–Ω–∏
3. –ü—Ä–∏ –∫–ª–∏–∫–µ ‚Üí –¥–∏–∞–ª–æ–≥ —Å –ø–æ–ª–µ–º –≤–≤–æ–¥–∞ ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ UserService

**–ó–∞—á–µ–º:** –ß—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–µ–ª —Å–≤–æ–µ –∏–º—è –∏ –º–æ–≥ –µ–≥–æ –∏–∑–º–µ–Ω–∏—Ç—å.

---

### SOSService - –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏–º–µ–Ω–∏ –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏**

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
1. –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ SOS –ø–æ–ª—É—á–∏—Ç—å –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ UserService
2. –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ:
   - –ï—Å–ª–∏ –∏–º—è –µ—Å—Ç—å: "‚ö†Ô∏è SOS Emergency from [–ò–º—è] ([ID])"
   - –ï—Å–ª–∏ –∏–º–µ–Ω–∏ –Ω–µ—Ç: "‚ö†Ô∏è SOS Emergency from [ID]"
3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Edge Function

**–ó–∞—á–µ–º:** –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∞—Ç–µ–ª—å SOS –≤–∏–¥–µ–ª –ö–¢–û –æ—Ç–ø—Ä–∞–≤–∏–ª, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ ID.

---

## üîÑ –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

1. **UserService** (–æ—Å–Ω–æ–≤–∞)
2. **WelcomeScreen** (UI –¥–ª—è –≤–≤–æ–¥–∞)
3. **main.dart —Ä–æ—É—Ç–∏–Ω–≥** (–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞)
4. **GuardiansService** (–ø–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
5. **GuardiansScreen** (—É–ª—É—á—à–µ–Ω–Ω—ã–π UI –¥–æ–±–∞–≤–ª–µ–Ω–∏—è)
6. **MainScreen** (–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–≤–æ–µ–≥–æ –∏–º–µ–Ω–∏)
7. **SOSService** (–æ—Ç–ø—Ä–∞–≤–∫–∞ —Å –∏–º–µ–Ω–µ–º)

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏:

**–õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (SharedPreferences):**
- `user_name` - –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `guardian1_nickname` - –ª–∏—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è —Ö—Ä–∞–Ω–∏—Ç–µ–ª—è 1
- `guardian2_nickname` - –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ

**Supabase:**
- –ö–æ–ª–æ–Ω–∫–∞ `user_name` –≤ —Ç–∞–±–ª–∏—Ü–µ `users`
- –ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏/–∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∏–º–µ–Ω–∏ ‚Üí UPDATE –≤ –±–∞–∑—É
- –ü—Ä–∏ –ø–æ–∏—Å–∫–µ —Ö—Ä–∞–Ω–∏—Ç–µ–ª—è ‚Üí SELECT –∏–∑ –±–∞–∑—ã

**UX:**
- –ü–æ–∏—Å–∫ –∏–º–µ–Ω–∏ —Ö—Ä–∞–Ω–∏—Ç–µ–ª—è ‚Üí –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –≤–≤–æ–¥–µ ID (debounce 500ms)
- –ï—Å–ª–∏ –Ω–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ ID (–∫—ç—à –Ω–µ –¥–µ–ª–∞–µ–º –Ω–∞ –ø–µ—Ä–≤–æ–º —ç—Ç–∞–ø–µ)
- Nickname –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω - –º–æ–∂–Ω–æ –Ω–µ –∑–∞–ø–æ–ª–Ω—è—Ç—å


